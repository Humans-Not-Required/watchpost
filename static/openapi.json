{
  "openapi": "3.0.3",
  "info": {
    "title": "Watchpost",
    "description": "Agent-native monitoring service. Create monitors, track uptime, receive alerts \u2014 all via REST API. No signup required.",
    "version": "0.1.0",
    "license": {
      "name": "MIT"
    }
  },
  "servers": [
    {
      "url": "/api/v1"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "summary": "Service health check",
        "operationId": "health",
        "tags": [
          "system"
        ],
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "service": {
                      "type": "string"
                    },
                    "status": {
                      "type": "string"
                    },
                    "version": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/monitors": {
      "get": {
        "summary": "List public monitors",
        "operationId": "listMonitors",
        "tags": [
          "monitors"
        ],
        "parameters": [
          {
            "name": "search",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter monitors by name or URL (case-insensitive substring match)"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "up",
                "down",
                "degraded",
                "unknown"
              ]
            },
            "description": "Filter by current status"
          },
          {
            "name": "tag",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter monitors by tag"
          },
          {
            "name": "group",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter monitors by group name"
          }
        ],
        "responses": {
          "200": {
            "description": "List of public monitors",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Monitor"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a monitor",
        "operationId": "createMonitor",
        "tags": [
          "monitors"
        ],
        "description": "Creates a new monitor and returns a manage_key (shown once). Save this key to manage the monitor later.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMonitor"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Monitor created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateMonitorResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "429": {
            "$ref": "#/components/responses/RateLimitError"
          }
        }
      }
    },
    "/monitors/bulk": {
      "post": {
        "summary": "Bulk create monitors",
        "operationId": "bulkCreateMonitors",
        "tags": [
          "monitors"
        ],
        "description": "Create up to 50 monitors in one request. Each monitor gets its own manage_key. Partial success: some may fail while others succeed. Each monitor counts against rate limit.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkCreateMonitors"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Bulk creation results (may include partial failures)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkCreateResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          }
        }
      }
    },
    "/monitors/{id}/export": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Export monitor config",
        "operationId": "exportMonitor",
        "tags": [
          "monitors"
        ],
        "description": "Export monitor configuration in a format compatible with POST /monitors or /monitors/bulk. Useful for backup, migration, or cloning.",
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Exportable monitor config",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExportedMonitor"
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/monitors/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Get monitor details",
        "operationId": "getMonitor",
        "tags": [
          "monitors"
        ],
        "responses": {
          "200": {
            "description": "Monitor details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Monitor"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      },
      "patch": {
        "summary": "Update monitor config",
        "operationId": "updateMonitor",
        "tags": [
          "monitors"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMonitor"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Monitor updated"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      },
      "delete": {
        "summary": "Delete monitor and all data",
        "operationId": "deleteMonitor",
        "tags": [
          "monitors"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Monitor deleted"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/monitors/{id}/pause": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "post": {
        "summary": "Pause monitor checks",
        "operationId": "pauseMonitor",
        "tags": [
          "monitors"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Monitor paused"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/monitors/{id}/resume": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "post": {
        "summary": "Resume monitor checks",
        "operationId": "resumeMonitor",
        "tags": [
          "monitors"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Monitor resumed"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/monitors/{id}/heartbeats": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Get check history",
        "operationId": "getHeartbeats",
        "tags": [
          "heartbeats"
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 50,
              "maximum": 200
            },
            "description": "Max results to return"
          },
          {
            "name": "after",
            "in": "query",
            "schema": {
              "type": "integer"
            },
            "description": "Return heartbeats with seq > this value (cursor-based pagination)"
          }
        ],
        "responses": {
          "200": {
            "description": "Check history (use last item's seq as after= for next page)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Heartbeat"
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/monitors/{id}/uptime": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Get uptime statistics",
        "operationId": "getUptime",
        "tags": [
          "heartbeats"
        ],
        "responses": {
          "200": {
            "description": "Uptime stats",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UptimeStats"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/monitors/{id}/incidents": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Get incident history",
        "operationId": "getIncidents",
        "tags": [
          "incidents"
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20,
              "maximum": 100
            },
            "description": "Max results to return"
          },
          {
            "name": "after",
            "in": "query",
            "schema": {
              "type": "integer"
            },
            "description": "Return incidents with seq > this value (cursor-based pagination)"
          }
        ],
        "responses": {
          "200": {
            "description": "Incident list (use last item's seq as after= for next page)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Incident"
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/incidents/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Get incident detail",
        "operationId": "getIncident",
        "tags": [
          "incidents"
        ],
        "responses": {
          "200": {
            "description": "Incident detail with notes count",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/Incident"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "notes_count": {
                          "type": "integer"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/incidents/{id}/acknowledge": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "post": {
        "summary": "Acknowledge an incident",
        "operationId": "acknowledgeIncident",
        "tags": [
          "incidents"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AcknowledgeIncident"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Incident acknowledged"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/incidents/{id}/notes": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "List incident notes",
        "operationId": "listIncidentNotes",
        "tags": [
          "incidents"
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 50,
              "maximum": 200
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Notes in chronological order",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/IncidentNote"
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      },
      "post": {
        "summary": "Add investigation note to incident",
        "operationId": "createIncidentNote",
        "tags": [
          "incidents"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateIncidentNote"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Note created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IncidentNote"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          },
          "422": {
            "description": "Validation error (empty content, content too long, empty author, author too long)"
          }
        }
      }
    },
    "/monitors/{id}/notifications": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "post": {
        "summary": "Add notification channel",
        "operationId": "createNotification",
        "tags": [
          "notifications"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateNotification"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Notification channel created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotificationChannel"
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      },
      "get": {
        "summary": "List notification channels",
        "operationId": "listNotifications",
        "tags": [
          "notifications"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Notification channels",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/NotificationChannel"
                  }
                }
              }
            }
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/notifications/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "delete": {
        "summary": "Remove notification channel",
        "operationId": "deleteNotification",
        "tags": [
          "notifications"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Notification deleted"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      },
      "patch": {
        "summary": "Enable or disable a notification channel",
        "operationId": "updateNotification",
        "tags": [
          "notifications"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "is_enabled": {
                    "type": "boolean"
                  },
                  "name": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Notification channel updated"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/dashboard": {
      "get": {
        "summary": "Dashboard overview with aggregate stats",
        "operationId": "dashboard",
        "tags": [
          "system"
        ],
        "description": "Returns aggregate statistics across all monitors: counts by status, uptime averages, active incidents, recent incidents with monitor names, and slowest monitors.",
        "responses": {
          "200": {
            "description": "Dashboard data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "total_monitors": {
                      "type": "integer"
                    },
                    "public_monitors": {
                      "type": "integer"
                    },
                    "paused_monitors": {
                      "type": "integer"
                    },
                    "status_counts": {
                      "type": "object",
                      "properties": {
                        "up": {
                          "type": "integer"
                        },
                        "down": {
                          "type": "integer"
                        },
                        "degraded": {
                          "type": "integer"
                        },
                        "unknown": {
                          "type": "integer"
                        },
                        "maintenance": {
                          "type": "integer"
                        }
                      }
                    },
                    "active_incidents": {
                      "type": "integer"
                    },
                    "avg_uptime_24h": {
                      "type": "number"
                    },
                    "avg_uptime_7d": {
                      "type": "number"
                    },
                    "avg_response_ms_24h": {
                      "type": "number",
                      "nullable": true
                    },
                    "total_checks_24h": {
                      "type": "integer"
                    },
                    "recent_incidents": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "monitor_id": {
                            "type": "string"
                          },
                          "monitor_name": {
                            "type": "string"
                          },
                          "started_at": {
                            "type": "string"
                          },
                          "resolved_at": {
                            "type": "string",
                            "nullable": true
                          },
                          "cause": {
                            "type": "string"
                          }
                        }
                      }
                    },
                    "slowest_monitors": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "avg_response_ms": {
                            "type": "number"
                          },
                          "current_status": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/uptime-history": {
      "get": {
        "summary": "Aggregate uptime history by day",
        "operationId": "uptimeHistory",
        "tags": [
          "system"
        ],
        "description": "Returns daily uptime percentages, check counts, and average response times aggregated across all monitors.",
        "parameters": [
          {
            "name": "days",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 30,
              "minimum": 1,
              "maximum": 90
            },
            "description": "Number of days of history"
          }
        ],
        "responses": {
          "200": {
            "description": "Daily uptime data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "format": "date"
                      },
                      "uptime_pct": {
                        "type": "number"
                      },
                      "total_checks": {
                        "type": "integer"
                      },
                      "up_checks": {
                        "type": "integer"
                      },
                      "down_checks": {
                        "type": "integer"
                      },
                      "avg_response_ms": {
                        "type": "number",
                        "nullable": true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/monitors/{id}/uptime-history": {
      "get": {
        "summary": "Per-monitor uptime history by day",
        "operationId": "monitorUptimeHistory",
        "tags": [
          "monitors"
        ],
        "description": "Returns daily uptime percentages, check counts, and average response times for a specific monitor.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "days",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 30,
              "minimum": 1,
              "maximum": 90
            },
            "description": "Number of days of history"
          }
        ],
        "responses": {
          "200": {
            "description": "Daily uptime data for the monitor",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "date": {
                        "type": "string",
                        "format": "date"
                      },
                      "uptime_pct": {
                        "type": "number"
                      },
                      "total_checks": {
                        "type": "integer"
                      },
                      "up_checks": {
                        "type": "integer"
                      },
                      "down_checks": {
                        "type": "integer"
                      },
                      "avg_response_ms": {
                        "type": "number",
                        "nullable": true
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Monitor not found"
          }
        }
      }
    },
    "/status": {
      "get": {
        "summary": "Public status page",
        "operationId": "statusPage",
        "tags": [
          "status"
        ],
        "parameters": [
          {
            "name": "search",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter monitors by name or URL (case-insensitive substring match)"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "up",
                "down",
                "degraded",
                "unknown"
              ]
            },
            "description": "Filter by current status"
          },
          {
            "name": "tag",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter monitors by tag"
          },
          {
            "name": "group",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "Filter monitors by group name"
          }
        ],
        "responses": {
          "200": {
            "description": "Status overview",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusOverview"
                }
              }
            }
          }
        }
      }
    },
    "/tags": {
      "get": {
        "summary": "List all unique tags",
        "operationId": "listTags",
        "tags": [
          "monitors"
        ],
        "description": "Returns sorted list of unique tags across all public monitors.",
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/groups": {
      "get": {
        "summary": "List all unique monitor groups",
        "operationId": "listGroups",
        "tags": [
          "monitors"
        ],
        "description": "Returns sorted list of unique group names across all public monitors.",
        "responses": {
          "200": {
            "description": "List of group names",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/events": {
      "get": {
        "summary": "Global SSE event stream",
        "operationId": "globalEvents",
        "tags": [
          "events"
        ],
        "responses": {
          "200": {
            "description": "SSE stream",
            "content": {
              "text/event-stream": {}
            }
          }
        }
      }
    },
    "/monitors/{id}/events": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "Per-monitor SSE event stream",
        "operationId": "monitorEvents",
        "tags": [
          "events"
        ],
        "responses": {
          "200": {
            "description": "SSE stream",
            "content": {
              "text/event-stream": {}
            }
          }
        }
      }
    },
    "/monitors/{id}/sla": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "get": {
        "summary": "SLA status with error budget tracking",
        "description": "Returns SLA compliance status including error budget remaining. Requires sla_target to be set on the monitor. Degraded checks count as successful.",
        "responses": {
          "200": {
            "description": "SLA status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "monitor_id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "target_pct": {
                      "type": "number",
                      "example": 99.9
                    },
                    "period_days": {
                      "type": "integer",
                      "example": 30
                    },
                    "current_pct": {
                      "type": "number",
                      "example": 99.95
                    },
                    "total_checks": {
                      "type": "integer"
                    },
                    "successful_checks": {
                      "type": "integer"
                    },
                    "downtime_estimate_seconds": {
                      "type": "number"
                    },
                    "budget_total_seconds": {
                      "type": "number",
                      "description": "Total allowed downtime in period"
                    },
                    "budget_remaining_seconds": {
                      "type": "number",
                      "description": "Remaining error budget (negative = breached)"
                    },
                    "budget_used_pct": {
                      "type": "number",
                      "description": "Percentage of error budget consumed"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "met",
                        "at_risk",
                        "breached"
                      ]
                    },
                    "period_start": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "period_end": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Monitor not found or SLA not configured"
          }
        }
      }
    },
    "/monitors/{id}/badge/uptime": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        },
        {
          "name": "period",
          "in": "query",
          "schema": {
            "type": "string",
            "enum": [
              "24h",
              "7d",
              "30d",
              "90d"
            ],
            "default": "24h"
          },
          "description": "Time period for uptime calculation"
        },
        {
          "name": "label",
          "in": "query",
          "schema": {
            "type": "string"
          },
          "description": "Custom badge label (default: uptime {period})"
        }
      ],
      "get": {
        "summary": "SVG uptime badge (shields.io style)",
        "operationId": "monitorUptimeBadge",
        "tags": [
          "badges"
        ],
        "description": "Returns an SVG badge showing the monitor uptime percentage. Embed in README markdown: ![uptime](url)",
        "responses": {
          "200": {
            "description": "SVG badge image",
            "content": {
              "image/svg+xml": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          }
        }
      }
    },
    "/monitors/{id}/badge/status": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        },
        {
          "name": "label",
          "in": "query",
          "schema": {
            "type": "string"
          },
          "description": "Custom badge label (default: status)"
        }
      ],
      "get": {
        "summary": "SVG current status badge",
        "operationId": "monitorStatusBadge",
        "tags": [
          "badges"
        ],
        "description": "Returns an SVG badge showing the monitor current status (up/down/degraded/unknown). Color-coded.",
        "responses": {
          "200": {
            "description": "SVG badge image",
            "content": {
              "image/svg+xml": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          }
        }
      }
    },
    "/monitors/{id}/maintenance": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "post": {
        "summary": "Create a maintenance window (suppresses incidents during the window)",
        "operationId": "createMaintenanceWindow",
        "tags": [
          "maintenance"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "title",
                  "starts_at",
                  "ends_at"
                ],
                "properties": {
                  "title": {
                    "type": "string",
                    "description": "Maintenance description"
                  },
                  "starts_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Window start (ISO-8601 UTC)"
                  },
                  "ends_at": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Window end (ISO-8601 UTC)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Maintenance window created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MaintenanceWindow"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "403": {
            "description": "Invalid manage key"
          }
        }
      },
      "get": {
        "summary": "List maintenance windows for a monitor",
        "operationId": "listMaintenanceWindows",
        "tags": [
          "maintenance"
        ],
        "responses": {
          "200": {
            "description": "List of maintenance windows",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MaintenanceWindow"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Monitor not found"
          }
        }
      }
    },
    "/maintenance/{id}": {
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "format": "uuid"
          }
        }
      ],
      "delete": {
        "summary": "Delete a maintenance window",
        "operationId": "deleteMaintenanceWindow",
        "tags": [
          "maintenance"
        ],
        "security": [
          {
            "manageKey": []
          }
        ],
        "responses": {
          "200": {
            "description": "Deleted"
          },
          "403": {
            "description": "Invalid manage key"
          },
          "404": {
            "description": "Maintenance window not found"
          }
        }
      }
    },
    "/llms.txt": {
      "get": {
        "summary": "AI agent discovery document",
        "operationId": "llmsTxt",
        "tags": [
          "system"
        ],
        "responses": {
          "200": {
            "description": "Agent-readable API summary",
            "content": {
              "text/plain": {}
            }
          }
        }
      }
    },
    "/settings": {
      "get": {
        "summary": "Get status page branding",
        "operationId": "getSettings",
        "tags": [
          "settings"
        ],
        "responses": {
          "200": {
            "description": "Current branding settings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Settings"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update status page branding",
        "operationId": "updateSettings",
        "tags": [
          "settings"
        ],
        "security": [
          {
            "adminKey": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSettings"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated branding settings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Settings"
                }
              }
            }
          },
          "403": {
            "description": "Invalid admin key"
          }
        }
      }
    },
    "/openapi.json": {
      "get": {
        "summary": "OpenAPI specification",
        "operationId": "openapiSpec",
        "tags": [
          "system"
        ],
        "responses": {
          "200": {
            "description": "This document",
            "content": {
              "application/json": {}
            }
          }
        }
      }
    },
    "/api/v1/locations": {
      "post": {
        "summary": "Register a check location",
        "description": "Create a new remote check location for multi-region probing. Returns a probe_key for authenticating probe submissions.",
        "tags": [
          "Check Locations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Unique name for the check location",
                    "maxLength": 200
                  },
                  "region": {
                    "type": "string",
                    "description": "Optional region identifier (e.g. us-east-1)",
                    "maxLength": 200
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Location created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "location": {
                      "$ref": "#/components/schemas/CheckLocation"
                    },
                    "probe_key": {
                      "type": "string",
                      "description": "Authentication key for this location (shown once)"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "409": {
            "description": "Duplicate name"
          }
        }
      },
      "get": {
        "summary": "List check locations",
        "description": "List all registered check locations.",
        "tags": [
          "Check Locations"
        ],
        "responses": {
          "200": {
            "description": "List of check locations",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CheckLocation"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/locations/{id}": {
      "get": {
        "summary": "Get check location",
        "tags": [
          "Check Locations"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Check location",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CheckLocation"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      },
      "delete": {
        "summary": "Delete check location",
        "tags": [
          "Check Locations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Deleted"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/api/v1/probe": {
      "post": {
        "summary": "Submit probe results",
        "description": "Submit check results from a remote check location. Authenticate with the probe_key returned when creating the location.",
        "tags": [
          "Check Locations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "results"
                ],
                "properties": {
                  "results": {
                    "type": "array",
                    "maxItems": 100,
                    "items": {
                      "type": "object",
                      "required": [
                        "monitor_id",
                        "status",
                        "response_time_ms"
                      ],
                      "properties": {
                        "monitor_id": {
                          "type": "string"
                        },
                        "status": {
                          "type": "string",
                          "enum": [
                            "up",
                            "down",
                            "degraded"
                          ]
                        },
                        "response_time_ms": {
                          "type": "integer"
                        },
                        "status_code": {
                          "type": "integer",
                          "nullable": true
                        },
                        "error_message": {
                          "type": "string",
                          "nullable": true
                        },
                        "checked_at": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Probe results processed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accepted": {
                      "type": "integer"
                    },
                    "rejected": {
                      "type": "integer"
                    },
                    "errors": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "index": {
                            "type": "integer"
                          },
                          "monitor_id": {
                            "type": "string"
                          },
                          "error": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/ValidationError"
          },
          "401": {
            "description": "Invalid or inactive probe key"
          }
        }
      }
    },
    "/api/v1/monitors/{id}/locations": {
      "get": {
        "summary": "Per-location status for a monitor",
        "description": "Returns the latest probe result from each active check location for the given monitor.",
        "tags": [
          "Check Locations"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Per-location status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MonitorLocationStatus"
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/api/v1/monitors/{id}/consensus": {
      "get": {
        "summary": "Multi-region consensus status",
        "description": "Returns the current consensus evaluation for a monitor with consensus_threshold configured. Shows per-location status and the aggregate effective status.",
        "tags": [
          "Check Locations"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Consensus status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConsensusStatus"
                }
              }
            }
          },
          "400": {
            "description": "Consensus not configured",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "code": {
                      "type": "string",
                      "example": "CONSENSUS_NOT_CONFIGURED"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/api/v1/monitors/{id}/alert-rules": {
      "get": {
        "summary": "Get alert rules",
        "description": "Returns the current alert rules for a monitor. Returns 404 if no rules are configured.",
        "tags": ["Alert Rules"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Alert rules",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/AlertRule" }
              }
            }
          },
          "404": { "description": "No alert rules configured" }
        }
      },
      "put": {
        "summary": "Set alert rules",
        "description": "Create or update alert rules for a monitor (upsert). Controls repeat notifications and escalation policies.",
        "tags": ["Alert Rules"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "repeat_interval_minutes": {
                    "type": "integer",
                    "description": "Re-send notifications every N minutes while incident is open. 0 = disabled. Min 5.",
                    "default": 0
                  },
                  "max_repeats": {
                    "type": "integer",
                    "description": "Maximum repeat notifications per incident. Default 10, max 100.",
                    "default": 10
                  },
                  "escalation_after_minutes": {
                    "type": "integer",
                    "description": "Send escalation alert if incident not acknowledged within N minutes. 0 = disabled. Min 5.",
                    "default": 0
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Alert rules saved",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/AlertRule" }
              }
            }
          },
          "400": { "description": "Validation error" }
        }
      },
      "delete": {
        "summary": "Remove alert rules",
        "description": "Delete all alert rules for a monitor.",
        "tags": ["Alert Rules"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": { "description": "Alert rules removed" },
          "404": { "description": "No alert rules configured" }
        }
      }
    },
    "/api/v1/monitors/{id}/alert-log": {
      "get": {
        "summary": "Alert notification log",
        "description": "View the history of alert notifications sent for a monitor. Includes initial alerts, reminders, escalations, and resolution notifications.",
        "tags": ["Alert Rules"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50, "maximum": 200 } },
          { "name": "after", "in": "query", "schema": { "type": "string", "format": "date-time" }, "description": "Only return entries sent after this timestamp" }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Alert log entries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/AlertLogEntry" }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/monitors/{id}/webhook-deliveries": {
      "get": {
        "summary": "Webhook delivery log",
        "description": "View the history of webhook delivery attempts for a monitor, including retries. Each delivery attempt is logged with status, response time, and error details. Grouped by delivery_group (one group per notification dispatch).",
        "tags": ["Notifications"],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50, "minimum": 1, "maximum": 200 } },
          { "name": "after", "in": "query", "schema": { "type": "integer" }, "description": "Cursor: only return entries with seq > this value" },
          { "name": "event", "in": "query", "schema": { "type": "string" }, "description": "Filter by event type (e.g., incident.created)" },
          { "name": "status", "in": "query", "schema": { "type": "string", "enum": ["success", "failed"] }, "description": "Filter by delivery status" }
        ],
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Webhook delivery log",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deliveries": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": { "type": "string" },
                          "delivery_group": { "type": "string", "description": "Groups all retry attempts for one dispatch" },
                          "monitor_id": { "type": "string" },
                          "event": { "type": "string" },
                          "url": { "type": "string" },
                          "attempt": { "type": "integer", "description": "Attempt number (1-3)" },
                          "status": { "type": "string", "enum": ["success", "failed"] },
                          "status_code": { "type": "integer", "nullable": true },
                          "error_message": { "type": "string", "nullable": true },
                          "response_time_ms": { "type": "integer" },
                          "created_at": { "type": "string", "format": "date-time" },
                          "seq": { "type": "integer" }
                        }
                      }
                    },
                    "total": { "type": "integer" }
                  }
                }
              }
            }
          },
          "401": { "description": "Missing manage key" },
          "403": { "description": "Invalid manage key" },
          "404": { "description": "Monitor not found" }
        }
      }
    },
    "/status-pages": {
      "post": {
        "summary": "Create a status page",
        "tags": [
          "Status Pages"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "slug",
                  "title"
                ],
                "properties": {
                  "slug": {
                    "type": "string",
                    "description": "URL-safe identifier (a-z, 0-9, hyphens, underscores)"
                  },
                  "title": {
                    "type": "string",
                    "maxLength": 200
                  },
                  "description": {
                    "type": "string",
                    "maxLength": 2000
                  },
                  "logo_url": {
                    "type": "string",
                    "maxLength": 2000
                  },
                  "custom_domain": {
                    "type": "string",
                    "maxLength": 253
                  },
                  "is_public": {
                    "type": "boolean",
                    "default": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Status page created with manage_key"
          },
          "400": {
            "description": "Validation error"
          },
          "409": {
            "description": "Slug or domain conflict"
          }
        }
      },
      "get": {
        "summary": "List public status pages",
        "tags": [
          "Status Pages"
        ],
        "responses": {
          "200": {
            "description": "Array of public status pages"
          }
        }
      }
    },
    "/status-pages/{slug_or_id}": {
      "get": {
        "summary": "Get status page detail with monitors",
        "tags": [
          "Status Pages"
        ],
        "parameters": [
          {
            "name": "slug_or_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Status page detail with monitors and overall status"
          },
          "404": {
            "description": "Status page not found"
          }
        }
      },
      "patch": {
        "summary": "Update status page",
        "tags": [
          "Status Pages"
        ],
        "security": [
          {
            "ManageKey": []
          }
        ],
        "parameters": [
          {
            "name": "slug_or_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "slug": {
                    "type": "string"
                  },
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "logo_url": {
                    "type": "string"
                  },
                  "custom_domain": {
                    "type": "string"
                  },
                  "is_public": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated status page"
          },
          "403": {
            "description": "Invalid manage key"
          },
          "404": {
            "description": "Status page not found"
          },
          "409": {
            "description": "Slug or domain conflict"
          }
        }
      },
      "delete": {
        "summary": "Delete status page",
        "tags": [
          "Status Pages"
        ],
        "security": [
          {
            "ManageKey": []
          }
        ],
        "parameters": [
          {
            "name": "slug_or_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Status page deleted"
          },
          "403": {
            "description": "Invalid manage key"
          },
          "404": {
            "description": "Status page not found"
          }
        }
      }
    },
    "/status-pages/{slug_or_id}/monitors": {
      "post": {
        "summary": "Add monitors to status page",
        "tags": [
          "Status Pages"
        ],
        "security": [
          {
            "ManageKey": []
          }
        ],
        "parameters": [
          {
            "name": "slug_or_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "monitor_ids"
                ],
                "properties": {
                  "monitor_ids": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "maxItems": 100
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Monitors added (with added/skipped/errors counts)"
          },
          "400": {
            "description": "Empty monitor_ids"
          },
          "403": {
            "description": "Invalid manage key"
          }
        }
      },
      "get": {
        "summary": "List monitors on a status page",
        "tags": [
          "Status Pages"
        ],
        "parameters": [
          {
            "name": "slug_or_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Array of monitor status objects"
          },
          "404": {
            "description": "Status page not found"
          }
        }
      }
    },
    "/status-pages/{slug_or_id}/monitors/{monitor_id}": {
      "delete": {
        "summary": "Remove monitor from status page",
        "tags": [
          "Status Pages"
        ],
        "security": [
          {
            "ManageKey": []
          }
        ],
        "parameters": [
          {
            "name": "slug_or_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "monitor_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Monitor removed from status page"
          },
          "403": {
            "description": "Invalid manage key"
          },
          "404": {
            "description": "Monitor not assigned to this page"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "manageKey": {
        "type": "http",
        "scheme": "bearer",
        "description": "Monitor manage_key. Also accepted as X-API-Key header or ?key= query param."
      },
      "adminKey": {
        "type": "http",
        "scheme": "bearer",
        "description": "Service admin key (auto-generated on first run, printed to stdout). Used for service-level settings."
      }
    },
    "schemas": {
      "AlertRule": {
        "type": "object",
        "properties": {
          "monitor_id": { "type": "string", "format": "uuid" },
          "repeat_interval_minutes": { "type": "integer", "description": "Minutes between repeat notifications. 0 = disabled." },
          "max_repeats": { "type": "integer", "description": "Maximum repeat notifications per incident." },
          "escalation_after_minutes": { "type": "integer", "description": "Minutes before escalation if not acknowledged. 0 = disabled." },
          "created_at": { "type": "string", "format": "date-time" },
          "updated_at": { "type": "string", "format": "date-time" }
        }
      },
      "AlertLogEntry": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "format": "uuid" },
          "monitor_id": { "type": "string", "format": "uuid" },
          "incident_id": { "type": "string", "format": "uuid", "nullable": true },
          "channel_id": { "type": "string", "format": "uuid", "nullable": true },
          "alert_type": { "type": "string", "enum": ["initial", "reminder", "escalation", "resolved"], "description": "Type of alert notification" },
          "event": { "type": "string", "description": "Event that triggered this alert (e.g. incident.created, incident.reminder)" },
          "sent_at": { "type": "string", "format": "date-time" }
        }
      },
      "Monitor": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "monitor_type": {
            "type": "string",
            "enum": [
              "http",
              "tcp",
              "dns"
            ],
            "description": "Monitor type: http for HTTP/HTTPS checks, tcp for TCP port connectivity, dns for DNS record resolution"
          },
          "dns_record_type": {
            "type": "string",
            "enum": [
              "A",
              "AAAA",
              "CNAME",
              "MX",
              "TXT",
              "NS",
              "SOA",
              "PTR",
              "SRV",
              "CAA"
            ],
            "default": "A",
            "description": "DNS record type to query (dns monitors only)"
          },
          "dns_expected": {
            "type": "string",
            "nullable": true,
            "description": "Expected resolved value for DNS monitors. If set, resolution must match (case-insensitive). Null = any resolution is OK."
          },
          "method": {
            "type": "string",
            "enum": [
              "GET",
              "HEAD",
              "POST"
            ],
            "description": "HTTP method (only applicable for http monitors)"
          },
          "interval_seconds": {
            "type": "integer",
            "minimum": 600
          },
          "timeout_ms": {
            "type": "integer"
          },
          "expected_status": {
            "type": "integer"
          },
          "body_contains": {
            "type": "string",
            "nullable": true
          },
          "headers": {
            "type": "object",
            "nullable": true
          },
          "is_public": {
            "type": "boolean"
          },
          "is_paused": {
            "type": "boolean"
          },
          "current_status": {
            "type": "string",
            "enum": [
              "unknown",
              "up",
              "down",
              "degraded",
              "maintenance"
            ]
          },
          "last_checked_at": {
            "type": "string",
            "nullable": true
          },
          "confirmation_threshold": {
            "type": "integer"
          },
          "response_time_threshold_ms": {
            "type": "integer",
            "nullable": true,
            "description": "Mark as degraded when response time exceeds this (ms). Null = disabled."
          },
          "follow_redirects": {
            "type": "boolean",
            "description": "Whether HTTP redirects are followed (default: true)"
          },
          "sla_target": {
            "type": "number",
            "nullable": true,
            "minimum": 0,
            "maximum": 100,
            "description": "SLA uptime target percentage (e.g., 99.9). Null = no SLA tracking."
          },
          "sla_period_days": {
            "type": "integer",
            "nullable": true,
            "minimum": 1,
            "maximum": 365,
            "description": "Rolling SLA evaluation period in days (default: 30). Only used when sla_target is set."
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Freeform tags for filtering monitors"
          },
          "group_name": {
            "type": "string",
            "nullable": true,
            "description": "Group name for organizing monitors into sections on the status page"
          },
          "consensus_threshold": {
            "type": "integer",
            "nullable": true,
            "minimum": 1,
            "description": "Minimum number of check locations that must report 'down' for the monitor to be considered down. Null = no consensus (single-location behavior). Requires multi-region check locations."
          },
          "created_at": {
            "type": "string"
          },
          "updated_at": {
            "type": "string"
          }
        }
      },
      "CreateMonitor": {
        "type": "object",
        "required": [
          "name",
          "url"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string",
            "description": "HTTP: must start with http:// or https://. TCP: host:port format. DNS: hostname (e.g., 'example.com')"
          },
          "monitor_type": {
            "type": "string",
            "enum": [
              "http",
              "tcp",
              "dns"
            ],
            "default": "http",
            "description": "Monitor type: http for HTTP/HTTPS endpoint checks, tcp for TCP port connectivity, dns for DNS record resolution"
          },
          "dns_record_type": {
            "type": "string",
            "enum": [
              "A",
              "AAAA",
              "CNAME",
              "MX",
              "TXT",
              "NS",
              "SOA",
              "PTR",
              "SRV",
              "CAA"
            ],
            "default": "A",
            "description": "DNS record type to query (dns monitors only)"
          },
          "dns_expected": {
            "type": "string",
            "nullable": true,
            "description": "Expected DNS resolved value (dns monitors only)"
          },
          "method": {
            "type": "string",
            "enum": [
              "GET",
              "HEAD",
              "POST"
            ],
            "default": "GET",
            "description": "HTTP method (ignored for TCP and DNS monitors)"
          },
          "interval_seconds": {
            "type": "integer",
            "minimum": 600,
            "default": 600
          },
          "timeout_ms": {
            "type": "integer",
            "default": 10000
          },
          "expected_status": {
            "type": "integer",
            "default": 200
          },
          "body_contains": {
            "type": "string"
          },
          "headers": {
            "type": "object"
          },
          "is_public": {
            "type": "boolean",
            "default": false
          },
          "confirmation_threshold": {
            "type": "integer",
            "minimum": 1,
            "maximum": 10,
            "default": 2
          },
          "response_time_threshold_ms": {
            "type": "integer",
            "minimum": 100,
            "nullable": true,
            "description": "Alert when response time exceeds this threshold (ms). Null = disabled."
          },
          "follow_redirects": {
            "type": "boolean",
            "default": true,
            "description": "Follow HTTP redirects (301, 302, etc.) up to 10 hops. Default: true."
          },
          "sla_target": {
            "type": "number",
            "nullable": true,
            "minimum": 0,
            "maximum": 100,
            "description": "SLA uptime target percentage (e.g., 99.9). Enables SLA tracking and error budget."
          },
          "sla_period_days": {
            "type": "integer",
            "nullable": true,
            "minimum": 1,
            "maximum": 365,
            "description": "Rolling SLA evaluation period in days (default: 30)."
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Freeform tags for filtering"
          },
          "group_name": {
            "type": "string",
            "nullable": true,
            "description": "Group name for organizing monitors into sections on the status page. Empty string clears."
          },
          "consensus_threshold": {
            "type": "integer",
            "nullable": true,
            "minimum": 1,
            "description": "Minimum number of check locations reporting 'down' to consider monitor down. Null = disabled."
          }
        }
      },
      "BulkCreateMonitors": {
        "type": "object",
        "required": [
          "monitors"
        ],
        "properties": {
          "monitors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateMonitor"
            },
            "maxItems": 50,
            "description": "Array of monitors to create (max 50)"
          }
        }
      },
      "BulkCreateResponse": {
        "type": "object",
        "properties": {
          "created": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateMonitorResponse"
            },
            "description": "Successfully created monitors with manage keys"
          },
          "errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkError"
            },
            "description": "Failed monitors with error details"
          },
          "total": {
            "type": "integer",
            "description": "Total monitors in request"
          },
          "succeeded": {
            "type": "integer",
            "description": "Number successfully created"
          },
          "failed": {
            "type": "integer",
            "description": "Number that failed"
          }
        }
      },
      "BulkError": {
        "type": "object",
        "properties": {
          "index": {
            "type": "integer",
            "description": "Index in the input array"
          },
          "error": {
            "type": "string"
          },
          "code": {
            "type": "string"
          }
        }
      },
      "ExportedMonitor": {
        "type": "object",
        "description": "Monitor config in a format compatible with POST /monitors for re-import",
        "properties": {
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "monitor_type": {
            "type": "string",
            "enum": [
              "http",
              "tcp",
              "dns"
            ]
          },
          "dns_record_type": {
            "type": "string",
            "enum": [
              "A",
              "AAAA",
              "CNAME",
              "MX",
              "TXT",
              "NS",
              "SOA",
              "PTR",
              "SRV",
              "CAA"
            ]
          },
          "dns_expected": {
            "type": "string",
            "nullable": true
          },
          "method": {
            "type": "string"
          },
          "interval_seconds": {
            "type": "integer"
          },
          "timeout_ms": {
            "type": "integer"
          },
          "expected_status": {
            "type": "integer"
          },
          "body_contains": {
            "type": "string",
            "nullable": true
          },
          "headers": {
            "type": "object",
            "nullable": true
          },
          "is_public": {
            "type": "boolean"
          },
          "confirmation_threshold": {
            "type": "integer"
          },
          "response_time_threshold_ms": {
            "type": "integer",
            "nullable": true
          },
          "sla_target": {
            "type": "number",
            "nullable": true
          },
          "sla_period_days": {
            "type": "integer",
            "nullable": true
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "UpdateMonitor": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "method": {
            "type": "string"
          },
          "interval_seconds": {
            "type": "integer"
          },
          "timeout_ms": {
            "type": "integer"
          },
          "expected_status": {
            "type": "integer"
          },
          "body_contains": {
            "type": "string"
          },
          "headers": {
            "type": "object"
          },
          "is_public": {
            "type": "boolean"
          },
          "confirmation_threshold": {
            "type": "integer"
          },
          "response_time_threshold_ms": {
            "type": "integer",
            "minimum": 100,
            "nullable": true,
            "description": "Set to threshold value, or null to disable."
          },
          "sla_target": {
            "type": "number",
            "nullable": true,
            "minimum": 0,
            "maximum": 100,
            "description": "SLA uptime target percentage. Set to null to remove SLA tracking."
          },
          "sla_period_days": {
            "type": "integer",
            "nullable": true,
            "minimum": 1,
            "maximum": 365,
            "description": "SLA rolling period in days. Set to null to remove."
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateMonitorResponse": {
        "type": "object",
        "properties": {
          "monitor": {
            "$ref": "#/components/schemas/Monitor"
          },
          "manage_key": {
            "type": "string",
            "description": "Save this! Only shown once."
          },
          "manage_url": {
            "type": "string"
          },
          "view_url": {
            "type": "string"
          },
          "api_base": {
            "type": "string"
          }
        }
      },
      "Heartbeat": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "monitor_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string",
            "enum": [
              "up",
              "down",
              "degraded"
            ]
          },
          "response_time_ms": {
            "type": "integer"
          },
          "status_code": {
            "type": "integer",
            "nullable": true
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "checked_at": {
            "type": "string"
          },
          "seq": {
            "type": "integer",
            "description": "Monotonic sequence number for cursor-based pagination"
          },
          "location_id": {
            "type": "string",
            "nullable": true,
            "description": "Check location ID (null for local checker)"
          }
        }
      },
      "Incident": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "monitor_id": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": "string"
          },
          "resolved_at": {
            "type": "string",
            "nullable": true
          },
          "cause": {
            "type": "string"
          },
          "acknowledgement": {
            "type": "string",
            "nullable": true
          },
          "acknowledged_by": {
            "type": "string",
            "nullable": true
          },
          "acknowledged_at": {
            "type": "string",
            "nullable": true
          },
          "seq": {
            "type": "integer",
            "description": "Monotonic sequence number for cursor-based pagination"
          }
        }
      },
      "AcknowledgeIncident": {
        "type": "object",
        "required": [
          "note"
        ],
        "properties": {
          "note": {
            "type": "string"
          },
          "actor": {
            "type": "string",
            "default": "anonymous"
          }
        }
      },
      "IncidentNote": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "incident_id": {
            "type": "string",
            "format": "uuid"
          },
          "content": {
            "type": "string",
            "maxLength": 10000
          },
          "author": {
            "type": "string",
            "maxLength": 200
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "CreateIncidentNote": {
        "type": "object",
        "required": [
          "content"
        ],
        "properties": {
          "content": {
            "type": "string",
            "minLength": 1,
            "maxLength": 10000,
            "description": "Note content (trimmed, must not be empty)"
          },
          "author": {
            "type": "string",
            "maxLength": 200,
            "default": "anonymous",
            "description": "Author name (defaults to anonymous)"
          }
        }
      },
      "UptimeStats": {
        "type": "object",
        "properties": {
          "monitor_id": {
            "type": "string"
          },
          "uptime_24h": {
            "type": "number"
          },
          "uptime_7d": {
            "type": "number"
          },
          "uptime_30d": {
            "type": "number"
          },
          "uptime_90d": {
            "type": "number"
          },
          "total_checks_24h": {
            "type": "integer"
          },
          "total_checks_7d": {
            "type": "integer"
          },
          "total_checks_30d": {
            "type": "integer"
          },
          "total_checks_90d": {
            "type": "integer"
          },
          "avg_response_ms_24h": {
            "type": "number",
            "nullable": true
          }
        }
      },
      "StatusOverview": {
        "type": "object",
        "properties": {
          "monitors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StatusMonitor"
            }
          },
          "overall": {
            "type": "string",
            "enum": [
              "operational",
              "degraded",
              "major_outage",
              "unknown"
            ]
          },
          "branding": {
            "$ref": "#/components/schemas/Settings",
            "nullable": true,
            "description": "Custom branding (omitted when not configured)"
          }
        }
      },
      "StatusMonitor": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "current_status": {
            "type": "string"
          },
          "last_checked_at": {
            "type": "string",
            "nullable": true
          },
          "uptime_24h": {
            "type": "number"
          },
          "uptime_7d": {
            "type": "number"
          },
          "avg_response_ms_24h": {
            "type": "number",
            "nullable": true
          },
          "active_incident": {
            "type": "boolean"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "group_name": {
            "type": "string",
            "nullable": true,
            "description": "Group section name"
          }
        }
      },
      "NotificationChannel": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "monitor_id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "channel_type": {
            "type": "string",
            "enum": [
              "webhook",
              "email"
            ]
          },
          "config": {
            "type": "object"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "created_at": {
            "type": "string"
          }
        }
      },
      "CreateNotification": {
        "type": "object",
        "required": [
          "name",
          "channel_type",
          "config"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "channel_type": {
            "type": "string",
            "enum": [
              "webhook",
              "email"
            ]
          },
          "config": {
            "type": "object",
            "description": "For webhook: {\"url\": \"...\"}, for email: {\"address\": \"...\"}"
          }
        }
      },
      "MaintenanceWindow": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "monitor_id": {
            "type": "string",
            "format": "uuid"
          },
          "title": {
            "type": "string"
          },
          "starts_at": {
            "type": "string",
            "format": "date-time"
          },
          "ends_at": {
            "type": "string",
            "format": "date-time"
          },
          "active": {
            "type": "boolean",
            "description": "Whether the window is currently active"
          },
          "created_at": {
            "type": "string"
          }
        }
      },
      "Settings": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "nullable": true,
            "description": "Custom status page title"
          },
          "description": {
            "type": "string",
            "nullable": true,
            "description": "Custom status page description"
          },
          "logo_url": {
            "type": "string",
            "nullable": true,
            "description": "Custom logo URL for status page"
          }
        }
      },
      "UpdateSettings": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "Set title (empty string clears)"
          },
          "description": {
            "type": "string",
            "description": "Set description (empty string clears)"
          },
          "logo_url": {
            "type": "string",
            "description": "Set logo URL (empty string clears)"
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string"
          },
          "code": {
            "type": "string"
          }
        }
      },
      "CheckLocation": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "region": {
            "type": "string",
            "nullable": true
          },
          "is_active": {
            "type": "boolean"
          },
          "last_seen_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "MonitorLocationStatus": {
        "type": "object",
        "properties": {
          "location_id": {
            "type": "string"
          },
          "location_name": {
            "type": "string"
          },
          "region": {
            "type": "string",
            "nullable": true
          },
          "last_status": {
            "type": "string",
            "enum": [
              "up",
              "down",
              "degraded"
            ]
          },
          "last_response_time_ms": {
            "type": "integer"
          },
          "last_checked_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ConsensusStatus": {
        "type": "object",
        "properties": {
          "monitor_id": {
            "type": "string"
          },
          "consensus_threshold": {
            "type": "integer",
            "description": "Minimum locations reporting down to trigger incident"
          },
          "total_locations": {
            "type": "integer",
            "description": "Total number of locations with recent heartbeats"
          },
          "up_count": {
            "type": "integer"
          },
          "down_count": {
            "type": "integer"
          },
          "degraded_count": {
            "type": "integer"
          },
          "unknown_count": {
            "type": "integer"
          },
          "effective_status": {
            "type": "string",
            "enum": [
              "up",
              "down",
              "degraded",
              "unknown"
            ],
            "description": "Aggregate status determined by consensus logic"
          },
          "locations": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "location_id": {
                  "type": "string",
                  "nullable": true,
                  "description": "Null for the local checker"
                },
                "location_name": {
                  "type": "string"
                },
                "region": {
                  "type": "string",
                  "nullable": true
                },
                "last_status": {
                  "type": "string"
                },
                "last_response_time_ms": {
                  "type": "integer"
                },
                "last_checked_at": {
                  "type": "string",
                  "format": "date-time"
                }
              }
            }
          }
        }
      }
    },
    "responses": {
      "NotFound": {
        "description": "Resource not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            }
          }
        }
      },
      "Forbidden": {
        "description": "Invalid manage key",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            }
          }
        }
      },
      "ValidationError": {
        "description": "Validation error",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            }
          }
        }
      },
      "RateLimitError": {
        "description": "Rate limit exceeded",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            }
          }
        }
      }
    }
  }
}